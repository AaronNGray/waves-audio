(function e(t,n,r){function s(o,u){if(!n[o]){if(!t[o]){var a=typeof require=="function"&&require;if(!u&&a)return a(o,!0);if(i)return i(o,!0);var f=new Error("Cannot find module '"+o+"'");throw f.code="MODULE_NOT_FOUND",f}var l=n[o]={exports:{}};t[o][0].call(l.exports,function(e){var n=t[o][1][e];return s(n?n:e)},l,l.exports,e,t,n,r)}return n[o].exports}var i=typeof require=="function"&&require;for(var o=0;o<r.length;o++)s(r[o]);return s})({1:[function(require,module,exports){
/* Generated by es6-transpiler v 0.7.14-2 *//**
 * @fileoverview WAVE audio library element: an event queue manager.
 * @author Karim.Barkati@ircam.fr, Norbert.Schnell@ircam.fr, Victor.Saiz@ircam.fr
 * @version 0.3.2
 * @description An event is made of an object (such as an engine) and a time (such as a time or a position).
 */

'use strict';

var EventQueue = (function(){var DP$0 = Object.defineProperty;

  function EventQueue() {
    this.__eventList = [];
    this.__isBackward = false;
  }Object.defineProperties(EventQueue.prototype, {length: {"get": length$get$0, "configurable": true, "enumerable": true}});DP$0(EventQueue, "prototype", {"configurable": false, "enumerable": false, "writable": false});

  /**
   * Clear the event list.
   * @public
   */
  EventQueue.prototype.clear = function() {
    this.__eventList = [];
  }

  /**
   * Compare two events based on their time only.
   * @private
   * @param {Event} a
   * @param {Event} b
   */
  EventQueue.prototype.__compare = function(a, b) {
    return a[1] - b[1];
  }

  /**
   * Compare two events based on their time only, in reverse order.
   * @private
   * @param {Event} a
   * @param {Event} b
   */
  EventQueue.prototype.__reverseCompare = function(a, b) {
    return b[1] - a[1];
  }


  /**
   * Sort the whole event list.
   * @public
   */
  EventQueue.prototype.__sort = function() {
    if (this.__isBackward) {
      this.__eventList.sort(this.__reverseCompare);
    } else {
      this.__eventList.sort(this.__compare);
    }
  }


  /**
   * Get the index of an object in the event list.
   */
  EventQueue.prototype.__indexOf = function(object) {
    for (var i = 0; i < this.__eventList.length; i++) {
      if (object === this.__eventList[i][0]) {
        return i;
      }
    }

    return -1;
  }

  // this.length helper
  function length$get$0() {
    return this.__eventList.length;
  }

  /**
   * Insert an event (an ordered pair [object, time]) into eventList.
   * @public
   * @param {Object} object reference
   * @param {Float} time for scheduling or sequencing, ie either time or position time
   */
  EventQueue.prototype.insert = function(object, time) {var sort = arguments[2];if(sort === void 0)sort = true;

    if (time < Infinity) {
      var index = this.__indexOf(object);

      if (index < 0) {
        // add new event
        this.__eventList.push([object, time]);
        this.__sort();
      } else {
        // update time of existing event
        this.__eventList[index][1] = time;

        // move first event if it is not first anymore
        if (index === 0 && this.__eventList.length > 1) {
          var secondTime = this.__eventList[1][1];

          if ((!this.__isBackward && time > secondTime) || (this.__isBackward && time <= secondTime))
            this.__sort();
        }
      }
    } else {
      this.remove(object);
    }
  }

  /**
   * Remove an event from the event list.
   * @public
   * @chainable
   * @param {Object} object of the event to remove (1 to 1 hypothesis)
   */
  EventQueue.prototype.remove = function(object) {
    // Search for the index of the object in the list (not the full event pair).
    var index = this.__indexOf(object);

    if (index >= 0) {
      this.__eventList.splice(index, 1);

      return this; // for chainability
    }
  }

  /**
   * Get first object from the event list.
   * @public
   */
  EventQueue.prototype.getFirstObject = function() {
    if (this.__eventList.length > 0)
      return this.__eventList[0][0];

    return null;
  }

  /**
   * Get time of first event from the event list (either time or position).
   * @public
   */
  EventQueue.prototype.getFirstTime = function() {
    if (this.__eventList.length > 0)
      return this.__eventList[0][1];

    return Infinity;
  }

  /**
   * Get time of the specified event from the event list (either time or position).
   * @public
   */
  EventQueue.prototype.getTimeAtIndex = function(index) {
    if (this.__eventList[index])
      return;

    return Infinity;
  }
;return EventQueue;})();

module.exports = EventQueue;
},{}],2:[function(require,module,exports){
/* Generated by es6-transpiler v 0.7.14-2 *//**
 * @fileoverview WAVE audio library element: a web audio scheduler, without time loop.
 * @author Karim.Barkati@ircam.fr, Norbert.Schnell@ircam.fr, Victor.Saiz@ircam.fr
 * @version 4.1.0
 */

'use strict';

var EventQueue = require("../event-queue");

var Scheduler = (function(){var DP$0 = Object.defineProperty;

  function Scheduler(parent) {
    this.__objects = []
    this.__parent = parent;
    this.__eventQueue = new EventQueue();
  }DP$0(Scheduler, "prototype", {"configurable": false, "enumerable": false, "writable": false});

  /**
   * Schedule a schedulable object and add it to the scheduling list.
   * @public
   */
  Scheduler.prototype.add = function(object) {
    var firstTime = this.__eventQueue.getFirstTime();

    // assign scheduler to schedulable object
    object.scheduler = this;

    // add to list of schedulable objects
    this.__objects.push(object);

    // reset object and get next scheduling time
    var time = object.reset(this.__parent.currentTime); // TODO: fix me to leave me

    // add event to queue of scheduled events
    this.__eventQueue.insert(object, time);

    var nextTime = this.__eventQueue.getFirstTime();

    if (nextTime !== firstTime)
      this.__parent.reschedule(nextTime);
  }

  /**
   * Unschedule a schedulable object and remove it from the scheduling list.
   */
  Scheduler.prototype.remove = function(object) {
    var index = this.__objects.indexOf(object);
    var firstTime = this.__eventQueue.getFirstTime();

    if (index >= 0) {
      // remove from object list
      this.__objects.splice(index, 1);

      // remove event from queue of scheduled events
      this.__eventQueue.remove(object);

    // reset schedulable object
      object.scheduler = null;

      var nextTime = this.__eventQueue.getFirstTime();

      if (nextTime !== firstTime)
        this.__parent.reschedule(nextTime);
    }
  }

  /**
   * Update next scheduling time of a scheduled object.
   * @param {Object} object reference
   * @param {Float} new scheduling time of its next event; "Infinity" means "remove from scheduling"
   */
  Scheduler.prototype.reschedule = function(object, time) {
    var firstTime = this.__eventQueue.getFirstTime();

    if (time === Infinity) {
      this.__eventQueue.remove(object);

      if (this.__eventQueue.empty) {
        this.__parent.reschedule(time);
      }
    } else {
      var wasEmpty = this.__eventQueue.empty;

      this.__eventQueue.insert(object, time);

      var nextTime = this.__eventQueue.getFirstTime();

      if (nextTime !== firstTime)
        this.__parent.reschedule(nextTime);
    }
  }

  /***********************************************************************
   *
   *  Functions called by parent
   *
   */

  /**
   * Reset all schedulables objects of this scheduler and return first time.
   */
  Scheduler.prototype.reset = function() {
    this.__eventQueue.clear();

    var object, time;

    for (var i = this.__objects.length - 1; i > 0; i--) {
      object = this.__objects[i];
      time = object.reset(this.time);
      this.__eventQueue.insert(object, time, false); // don't sort
    }

    object = this.__objects[0];
    time = object.reset(this.time);
    this.__eventQueue.insert(object, time, true); // now sort

    return this.__eventQueue.getFirstTime();
  }

  /**
   * Call the event making method of the first schedulable object,
   * and then update the first event of the queue.
   * @public
   */
  Scheduler.prototype.execute = function() {
    var object = this.__eventQueue.getFirstObject();
    var time = this.__eventQueue.getFirstTime();
    var nextTime = object.execute(time);

    this.__eventQueue.insert(object, nextTime);

    return this.__eventQueue.getFirstTime();
  }
;return Scheduler;})();

module.exports = Scheduler;
},{"../event-queue":1}]},{},[2])
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIi9Vc2Vycy9zY2huZWxsL0RldmVsb3BtZW50L3dlYi9taXNjL2d1bHBCcm93RXJzeTYvbm9kZV9tb2R1bGVzL2Jyb3dzZXJpZnkvbm9kZV9tb2R1bGVzL2Jyb3dzZXItcGFjay9fcHJlbHVkZS5qcyIsIi9Vc2Vycy9zY2huZWxsL0RldmVsb3BtZW50L3dlYi93YXZlL2xpYi9naXRodWIvYXVkaW8vZXZlbnQtcXVldWUvaW5kZXguanMiLCIvVXNlcnMvc2NobmVsbC9EZXZlbG9wbWVudC93ZWIvd2F2ZS9saWIvZ2l0aHViL2F1ZGlvL3NjaGVkdWxlci9pbmRleC5qcyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQTtBQ0FBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBOztBQy9KQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBIiwiZmlsZSI6ImdlbmVyYXRlZC5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzQ29udGVudCI6WyIoZnVuY3Rpb24gZSh0LG4scil7ZnVuY3Rpb24gcyhvLHUpe2lmKCFuW29dKXtpZighdFtvXSl7dmFyIGE9dHlwZW9mIHJlcXVpcmU9PVwiZnVuY3Rpb25cIiYmcmVxdWlyZTtpZighdSYmYSlyZXR1cm4gYShvLCEwKTtpZihpKXJldHVybiBpKG8sITApO3ZhciBmPW5ldyBFcnJvcihcIkNhbm5vdCBmaW5kIG1vZHVsZSAnXCIrbytcIidcIik7dGhyb3cgZi5jb2RlPVwiTU9EVUxFX05PVF9GT1VORFwiLGZ9dmFyIGw9bltvXT17ZXhwb3J0czp7fX07dFtvXVswXS5jYWxsKGwuZXhwb3J0cyxmdW5jdGlvbihlKXt2YXIgbj10W29dWzFdW2VdO3JldHVybiBzKG4/bjplKX0sbCxsLmV4cG9ydHMsZSx0LG4scil9cmV0dXJuIG5bb10uZXhwb3J0c312YXIgaT10eXBlb2YgcmVxdWlyZT09XCJmdW5jdGlvblwiJiZyZXF1aXJlO2Zvcih2YXIgbz0wO288ci5sZW5ndGg7bysrKXMocltvXSk7cmV0dXJuIHN9KSIsIi8qIEdlbmVyYXRlZCBieSBlczYtdHJhbnNwaWxlciB2IDAuNy4xNC0yICovLyoqXG4gKiBAZmlsZW92ZXJ2aWV3IFdBVkUgYXVkaW8gbGlicmFyeSBlbGVtZW50OiBhbiBldmVudCBxdWV1ZSBtYW5hZ2VyLlxuICogQGF1dGhvciBLYXJpbS5CYXJrYXRpQGlyY2FtLmZyLCBOb3JiZXJ0LlNjaG5lbGxAaXJjYW0uZnIsIFZpY3Rvci5TYWl6QGlyY2FtLmZyXG4gKiBAdmVyc2lvbiAwLjMuMlxuICogQGRlc2NyaXB0aW9uIEFuIGV2ZW50IGlzIG1hZGUgb2YgYW4gb2JqZWN0IChzdWNoIGFzIGFuIGVuZ2luZSkgYW5kIGEgdGltZSAoc3VjaCBhcyBhIHRpbWUgb3IgYSBwb3NpdGlvbikuXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgRXZlbnRRdWV1ZSA9IChmdW5jdGlvbigpe3ZhciBEUCQwID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG4gIGZ1bmN0aW9uIEV2ZW50UXVldWUoKSB7XG4gICAgdGhpcy5fX2V2ZW50TGlzdCA9IFtdO1xuICAgIHRoaXMuX19pc0JhY2t3YXJkID0gZmFsc2U7XG4gIH1PYmplY3QuZGVmaW5lUHJvcGVydGllcyhFdmVudFF1ZXVlLnByb3RvdHlwZSwge2xlbmd0aDoge1wiZ2V0XCI6IGxlbmd0aCRnZXQkMCwgXCJjb25maWd1cmFibGVcIjogdHJ1ZSwgXCJlbnVtZXJhYmxlXCI6IHRydWV9fSk7RFAkMChFdmVudFF1ZXVlLCBcInByb3RvdHlwZVwiLCB7XCJjb25maWd1cmFibGVcIjogZmFsc2UsIFwiZW51bWVyYWJsZVwiOiBmYWxzZSwgXCJ3cml0YWJsZVwiOiBmYWxzZX0pO1xuXG4gIC8qKlxuICAgKiBDbGVhciB0aGUgZXZlbnQgbGlzdC5cbiAgICogQHB1YmxpY1xuICAgKi9cbiAgRXZlbnRRdWV1ZS5wcm90b3R5cGUuY2xlYXIgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9fZXZlbnRMaXN0ID0gW107XG4gIH1cblxuICAvKipcbiAgICogQ29tcGFyZSB0d28gZXZlbnRzIGJhc2VkIG9uIHRoZWlyIHRpbWUgb25seS5cbiAgICogQHByaXZhdGVcbiAgICogQHBhcmFtIHtFdmVudH0gYVxuICAgKiBAcGFyYW0ge0V2ZW50fSBiXG4gICAqL1xuICBFdmVudFF1ZXVlLnByb3RvdHlwZS5fX2NvbXBhcmUgPSBmdW5jdGlvbihhLCBiKSB7XG4gICAgcmV0dXJuIGFbMV0gLSBiWzFdO1xuICB9XG5cbiAgLyoqXG4gICAqIENvbXBhcmUgdHdvIGV2ZW50cyBiYXNlZCBvbiB0aGVpciB0aW1lIG9ubHksIGluIHJldmVyc2Ugb3JkZXIuXG4gICAqIEBwcml2YXRlXG4gICAqIEBwYXJhbSB7RXZlbnR9IGFcbiAgICogQHBhcmFtIHtFdmVudH0gYlxuICAgKi9cbiAgRXZlbnRRdWV1ZS5wcm90b3R5cGUuX19yZXZlcnNlQ29tcGFyZSA9IGZ1bmN0aW9uKGEsIGIpIHtcbiAgICByZXR1cm4gYlsxXSAtIGFbMV07XG4gIH1cblxuXG4gIC8qKlxuICAgKiBTb3J0IHRoZSB3aG9sZSBldmVudCBsaXN0LlxuICAgKiBAcHVibGljXG4gICAqL1xuICBFdmVudFF1ZXVlLnByb3RvdHlwZS5fX3NvcnQgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5fX2lzQmFja3dhcmQpIHtcbiAgICAgIHRoaXMuX19ldmVudExpc3Quc29ydCh0aGlzLl9fcmV2ZXJzZUNvbXBhcmUpO1xuICAgIH0gZWxzZSB7XG4gICAgICB0aGlzLl9fZXZlbnRMaXN0LnNvcnQodGhpcy5fX2NvbXBhcmUpO1xuICAgIH1cbiAgfVxuXG5cbiAgLyoqXG4gICAqIEdldCB0aGUgaW5kZXggb2YgYW4gb2JqZWN0IGluIHRoZSBldmVudCBsaXN0LlxuICAgKi9cbiAgRXZlbnRRdWV1ZS5wcm90b3R5cGUuX19pbmRleE9mID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgZm9yICh2YXIgaSA9IDA7IGkgPCB0aGlzLl9fZXZlbnRMaXN0Lmxlbmd0aDsgaSsrKSB7XG4gICAgICBpZiAob2JqZWN0ID09PSB0aGlzLl9fZXZlbnRMaXN0W2ldWzBdKSB7XG4gICAgICAgIHJldHVybiBpO1xuICAgICAgfVxuICAgIH1cblxuICAgIHJldHVybiAtMTtcbiAgfVxuXG4gIC8vIHRoaXMubGVuZ3RoIGhlbHBlclxuICBmdW5jdGlvbiBsZW5ndGgkZ2V0JDAoKSB7XG4gICAgcmV0dXJuIHRoaXMuX19ldmVudExpc3QubGVuZ3RoO1xuICB9XG5cbiAgLyoqXG4gICAqIEluc2VydCBhbiBldmVudCAoYW4gb3JkZXJlZCBwYWlyIFtvYmplY3QsIHRpbWVdKSBpbnRvIGV2ZW50TGlzdC5cbiAgICogQHB1YmxpY1xuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IHJlZmVyZW5jZVxuICAgKiBAcGFyYW0ge0Zsb2F0fSB0aW1lIGZvciBzY2hlZHVsaW5nIG9yIHNlcXVlbmNpbmcsIGllIGVpdGhlciB0aW1lIG9yIHBvc2l0aW9uIHRpbWVcbiAgICovXG4gIEV2ZW50UXVldWUucHJvdG90eXBlLmluc2VydCA9IGZ1bmN0aW9uKG9iamVjdCwgdGltZSkge3ZhciBzb3J0ID0gYXJndW1lbnRzWzJdO2lmKHNvcnQgPT09IHZvaWQgMClzb3J0ID0gdHJ1ZTtcblxuICAgIGlmICh0aW1lIDwgSW5maW5pdHkpIHtcbiAgICAgIHZhciBpbmRleCA9IHRoaXMuX19pbmRleE9mKG9iamVjdCk7XG5cbiAgICAgIGlmIChpbmRleCA8IDApIHtcbiAgICAgICAgLy8gYWRkIG5ldyBldmVudFxuICAgICAgICB0aGlzLl9fZXZlbnRMaXN0LnB1c2goW29iamVjdCwgdGltZV0pO1xuICAgICAgICB0aGlzLl9fc29ydCgpO1xuICAgICAgfSBlbHNlIHtcbiAgICAgICAgLy8gdXBkYXRlIHRpbWUgb2YgZXhpc3RpbmcgZXZlbnRcbiAgICAgICAgdGhpcy5fX2V2ZW50TGlzdFtpbmRleF1bMV0gPSB0aW1lO1xuXG4gICAgICAgIC8vIG1vdmUgZmlyc3QgZXZlbnQgaWYgaXQgaXMgbm90IGZpcnN0IGFueW1vcmVcbiAgICAgICAgaWYgKGluZGV4ID09PSAwICYmIHRoaXMuX19ldmVudExpc3QubGVuZ3RoID4gMSkge1xuICAgICAgICAgIHZhciBzZWNvbmRUaW1lID0gdGhpcy5fX2V2ZW50TGlzdFsxXVsxXTtcblxuICAgICAgICAgIGlmICgoIXRoaXMuX19pc0JhY2t3YXJkICYmIHRpbWUgPiBzZWNvbmRUaW1lKSB8fCAodGhpcy5fX2lzQmFja3dhcmQgJiYgdGltZSA8PSBzZWNvbmRUaW1lKSlcbiAgICAgICAgICAgIHRoaXMuX19zb3J0KCk7XG4gICAgICAgIH1cbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdGhpcy5yZW1vdmUob2JqZWN0KTtcbiAgICB9XG4gIH1cblxuICAvKipcbiAgICogUmVtb3ZlIGFuIGV2ZW50IGZyb20gdGhlIGV2ZW50IGxpc3QuXG4gICAqIEBwdWJsaWNcbiAgICogQGNoYWluYWJsZVxuICAgKiBAcGFyYW0ge09iamVjdH0gb2JqZWN0IG9mIHRoZSBldmVudCB0byByZW1vdmUgKDEgdG8gMSBoeXBvdGhlc2lzKVxuICAgKi9cbiAgRXZlbnRRdWV1ZS5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgLy8gU2VhcmNoIGZvciB0aGUgaW5kZXggb2YgdGhlIG9iamVjdCBpbiB0aGUgbGlzdCAobm90IHRoZSBmdWxsIGV2ZW50IHBhaXIpLlxuICAgIHZhciBpbmRleCA9IHRoaXMuX19pbmRleE9mKG9iamVjdCk7XG5cbiAgICBpZiAoaW5kZXggPj0gMCkge1xuICAgICAgdGhpcy5fX2V2ZW50TGlzdC5zcGxpY2UoaW5kZXgsIDEpO1xuXG4gICAgICByZXR1cm4gdGhpczsgLy8gZm9yIGNoYWluYWJpbGl0eVxuICAgIH1cbiAgfVxuXG4gIC8qKlxuICAgKiBHZXQgZmlyc3Qgb2JqZWN0IGZyb20gdGhlIGV2ZW50IGxpc3QuXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIEV2ZW50UXVldWUucHJvdG90eXBlLmdldEZpcnN0T2JqZWN0ID0gZnVuY3Rpb24oKSB7XG4gICAgaWYgKHRoaXMuX19ldmVudExpc3QubGVuZ3RoID4gMClcbiAgICAgIHJldHVybiB0aGlzLl9fZXZlbnRMaXN0WzBdWzBdO1xuXG4gICAgcmV0dXJuIG51bGw7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRpbWUgb2YgZmlyc3QgZXZlbnQgZnJvbSB0aGUgZXZlbnQgbGlzdCAoZWl0aGVyIHRpbWUgb3IgcG9zaXRpb24pLlxuICAgKiBAcHVibGljXG4gICAqL1xuICBFdmVudFF1ZXVlLnByb3RvdHlwZS5nZXRGaXJzdFRpbWUgPSBmdW5jdGlvbigpIHtcbiAgICBpZiAodGhpcy5fX2V2ZW50TGlzdC5sZW5ndGggPiAwKVxuICAgICAgcmV0dXJuIHRoaXMuX19ldmVudExpc3RbMF1bMV07XG5cbiAgICByZXR1cm4gSW5maW5pdHk7XG4gIH1cblxuICAvKipcbiAgICogR2V0IHRpbWUgb2YgdGhlIHNwZWNpZmllZCBldmVudCBmcm9tIHRoZSBldmVudCBsaXN0IChlaXRoZXIgdGltZSBvciBwb3NpdGlvbikuXG4gICAqIEBwdWJsaWNcbiAgICovXG4gIEV2ZW50UXVldWUucHJvdG90eXBlLmdldFRpbWVBdEluZGV4ID0gZnVuY3Rpb24oaW5kZXgpIHtcbiAgICBpZiAodGhpcy5fX2V2ZW50TGlzdFtpbmRleF0pXG4gICAgICByZXR1cm47XG5cbiAgICByZXR1cm4gSW5maW5pdHk7XG4gIH1cbjtyZXR1cm4gRXZlbnRRdWV1ZTt9KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IEV2ZW50UXVldWU7IiwiLyogR2VuZXJhdGVkIGJ5IGVzNi10cmFuc3BpbGVyIHYgMC43LjE0LTIgKi8vKipcbiAqIEBmaWxlb3ZlcnZpZXcgV0FWRSBhdWRpbyBsaWJyYXJ5IGVsZW1lbnQ6IGEgd2ViIGF1ZGlvIHNjaGVkdWxlciwgd2l0aG91dCB0aW1lIGxvb3AuXG4gKiBAYXV0aG9yIEthcmltLkJhcmthdGlAaXJjYW0uZnIsIE5vcmJlcnQuU2NobmVsbEBpcmNhbS5mciwgVmljdG9yLlNhaXpAaXJjYW0uZnJcbiAqIEB2ZXJzaW9uIDQuMS4wXG4gKi9cblxuJ3VzZSBzdHJpY3QnO1xuXG52YXIgRXZlbnRRdWV1ZSA9IHJlcXVpcmUoXCIuLi9ldmVudC1xdWV1ZVwiKTtcblxudmFyIFNjaGVkdWxlciA9IChmdW5jdGlvbigpe3ZhciBEUCQwID0gT2JqZWN0LmRlZmluZVByb3BlcnR5O1xuXG4gIGZ1bmN0aW9uIFNjaGVkdWxlcihwYXJlbnQpIHtcbiAgICB0aGlzLl9fb2JqZWN0cyA9IFtdXG4gICAgdGhpcy5fX3BhcmVudCA9IHBhcmVudDtcbiAgICB0aGlzLl9fZXZlbnRRdWV1ZSA9IG5ldyBFdmVudFF1ZXVlKCk7XG4gIH1EUCQwKFNjaGVkdWxlciwgXCJwcm90b3R5cGVcIiwge1wiY29uZmlndXJhYmxlXCI6IGZhbHNlLCBcImVudW1lcmFibGVcIjogZmFsc2UsIFwid3JpdGFibGVcIjogZmFsc2V9KTtcblxuICAvKipcbiAgICogU2NoZWR1bGUgYSBzY2hlZHVsYWJsZSBvYmplY3QgYW5kIGFkZCBpdCB0byB0aGUgc2NoZWR1bGluZyBsaXN0LlxuICAgKiBAcHVibGljXG4gICAqL1xuICBTY2hlZHVsZXIucHJvdG90eXBlLmFkZCA9IGZ1bmN0aW9uKG9iamVjdCkge1xuICAgIHZhciBmaXJzdFRpbWUgPSB0aGlzLl9fZXZlbnRRdWV1ZS5nZXRGaXJzdFRpbWUoKTtcblxuICAgIC8vIGFzc2lnbiBzY2hlZHVsZXIgdG8gc2NoZWR1bGFibGUgb2JqZWN0XG4gICAgb2JqZWN0LnNjaGVkdWxlciA9IHRoaXM7XG5cbiAgICAvLyBhZGQgdG8gbGlzdCBvZiBzY2hlZHVsYWJsZSBvYmplY3RzXG4gICAgdGhpcy5fX29iamVjdHMucHVzaChvYmplY3QpO1xuXG4gICAgLy8gcmVzZXQgb2JqZWN0IGFuZCBnZXQgbmV4dCBzY2hlZHVsaW5nIHRpbWVcbiAgICB2YXIgdGltZSA9IG9iamVjdC5yZXNldCh0aGlzLl9fcGFyZW50LmN1cnJlbnRUaW1lKTsgLy8gVE9ETzogZml4IG1lIHRvIGxlYXZlIG1lXG5cbiAgICAvLyBhZGQgZXZlbnQgdG8gcXVldWUgb2Ygc2NoZWR1bGVkIGV2ZW50c1xuICAgIHRoaXMuX19ldmVudFF1ZXVlLmluc2VydChvYmplY3QsIHRpbWUpO1xuXG4gICAgdmFyIG5leHRUaW1lID0gdGhpcy5fX2V2ZW50UXVldWUuZ2V0Rmlyc3RUaW1lKCk7XG5cbiAgICBpZiAobmV4dFRpbWUgIT09IGZpcnN0VGltZSlcbiAgICAgIHRoaXMuX19wYXJlbnQucmVzY2hlZHVsZShuZXh0VGltZSk7XG4gIH1cblxuICAvKipcbiAgICogVW5zY2hlZHVsZSBhIHNjaGVkdWxhYmxlIG9iamVjdCBhbmQgcmVtb3ZlIGl0IGZyb20gdGhlIHNjaGVkdWxpbmcgbGlzdC5cbiAgICovXG4gIFNjaGVkdWxlci5wcm90b3R5cGUucmVtb3ZlID0gZnVuY3Rpb24ob2JqZWN0KSB7XG4gICAgdmFyIGluZGV4ID0gdGhpcy5fX29iamVjdHMuaW5kZXhPZihvYmplY3QpO1xuICAgIHZhciBmaXJzdFRpbWUgPSB0aGlzLl9fZXZlbnRRdWV1ZS5nZXRGaXJzdFRpbWUoKTtcblxuICAgIGlmIChpbmRleCA+PSAwKSB7XG4gICAgICAvLyByZW1vdmUgZnJvbSBvYmplY3QgbGlzdFxuICAgICAgdGhpcy5fX29iamVjdHMuc3BsaWNlKGluZGV4LCAxKTtcblxuICAgICAgLy8gcmVtb3ZlIGV2ZW50IGZyb20gcXVldWUgb2Ygc2NoZWR1bGVkIGV2ZW50c1xuICAgICAgdGhpcy5fX2V2ZW50UXVldWUucmVtb3ZlKG9iamVjdCk7XG5cbiAgICAvLyByZXNldCBzY2hlZHVsYWJsZSBvYmplY3RcbiAgICAgIG9iamVjdC5zY2hlZHVsZXIgPSBudWxsO1xuXG4gICAgICB2YXIgbmV4dFRpbWUgPSB0aGlzLl9fZXZlbnRRdWV1ZS5nZXRGaXJzdFRpbWUoKTtcblxuICAgICAgaWYgKG5leHRUaW1lICE9PSBmaXJzdFRpbWUpXG4gICAgICAgIHRoaXMuX19wYXJlbnQucmVzY2hlZHVsZShuZXh0VGltZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqXG4gICAqIFVwZGF0ZSBuZXh0IHNjaGVkdWxpbmcgdGltZSBvZiBhIHNjaGVkdWxlZCBvYmplY3QuXG4gICAqIEBwYXJhbSB7T2JqZWN0fSBvYmplY3QgcmVmZXJlbmNlXG4gICAqIEBwYXJhbSB7RmxvYXR9IG5ldyBzY2hlZHVsaW5nIHRpbWUgb2YgaXRzIG5leHQgZXZlbnQ7IFwiSW5maW5pdHlcIiBtZWFucyBcInJlbW92ZSBmcm9tIHNjaGVkdWxpbmdcIlxuICAgKi9cbiAgU2NoZWR1bGVyLnByb3RvdHlwZS5yZXNjaGVkdWxlID0gZnVuY3Rpb24ob2JqZWN0LCB0aW1lKSB7XG4gICAgdmFyIGZpcnN0VGltZSA9IHRoaXMuX19ldmVudFF1ZXVlLmdldEZpcnN0VGltZSgpO1xuXG4gICAgaWYgKHRpbWUgPT09IEluZmluaXR5KSB7XG4gICAgICB0aGlzLl9fZXZlbnRRdWV1ZS5yZW1vdmUob2JqZWN0KTtcblxuICAgICAgaWYgKHRoaXMuX19ldmVudFF1ZXVlLmVtcHR5KSB7XG4gICAgICAgIHRoaXMuX19wYXJlbnQucmVzY2hlZHVsZSh0aW1lKTtcbiAgICAgIH1cbiAgICB9IGVsc2Uge1xuICAgICAgdmFyIHdhc0VtcHR5ID0gdGhpcy5fX2V2ZW50UXVldWUuZW1wdHk7XG5cbiAgICAgIHRoaXMuX19ldmVudFF1ZXVlLmluc2VydChvYmplY3QsIHRpbWUpO1xuXG4gICAgICB2YXIgbmV4dFRpbWUgPSB0aGlzLl9fZXZlbnRRdWV1ZS5nZXRGaXJzdFRpbWUoKTtcblxuICAgICAgaWYgKG5leHRUaW1lICE9PSBmaXJzdFRpbWUpXG4gICAgICAgIHRoaXMuX19wYXJlbnQucmVzY2hlZHVsZShuZXh0VGltZSk7XG4gICAgfVxuICB9XG5cbiAgLyoqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqKioqXG4gICAqXG4gICAqICBGdW5jdGlvbnMgY2FsbGVkIGJ5IHBhcmVudFxuICAgKlxuICAgKi9cblxuICAvKipcbiAgICogUmVzZXQgYWxsIHNjaGVkdWxhYmxlcyBvYmplY3RzIG9mIHRoaXMgc2NoZWR1bGVyIGFuZCByZXR1cm4gZmlyc3QgdGltZS5cbiAgICovXG4gIFNjaGVkdWxlci5wcm90b3R5cGUucmVzZXQgPSBmdW5jdGlvbigpIHtcbiAgICB0aGlzLl9fZXZlbnRRdWV1ZS5jbGVhcigpO1xuXG4gICAgdmFyIG9iamVjdCwgdGltZTtcblxuICAgIGZvciAodmFyIGkgPSB0aGlzLl9fb2JqZWN0cy5sZW5ndGggLSAxOyBpID4gMDsgaS0tKSB7XG4gICAgICBvYmplY3QgPSB0aGlzLl9fb2JqZWN0c1tpXTtcbiAgICAgIHRpbWUgPSBvYmplY3QucmVzZXQodGhpcy50aW1lKTtcbiAgICAgIHRoaXMuX19ldmVudFF1ZXVlLmluc2VydChvYmplY3QsIHRpbWUsIGZhbHNlKTsgLy8gZG9uJ3Qgc29ydFxuICAgIH1cblxuICAgIG9iamVjdCA9IHRoaXMuX19vYmplY3RzWzBdO1xuICAgIHRpbWUgPSBvYmplY3QucmVzZXQodGhpcy50aW1lKTtcbiAgICB0aGlzLl9fZXZlbnRRdWV1ZS5pbnNlcnQob2JqZWN0LCB0aW1lLCB0cnVlKTsgLy8gbm93IHNvcnRcblxuICAgIHJldHVybiB0aGlzLl9fZXZlbnRRdWV1ZS5nZXRGaXJzdFRpbWUoKTtcbiAgfVxuXG4gIC8qKlxuICAgKiBDYWxsIHRoZSBldmVudCBtYWtpbmcgbWV0aG9kIG9mIHRoZSBmaXJzdCBzY2hlZHVsYWJsZSBvYmplY3QsXG4gICAqIGFuZCB0aGVuIHVwZGF0ZSB0aGUgZmlyc3QgZXZlbnQgb2YgdGhlIHF1ZXVlLlxuICAgKiBAcHVibGljXG4gICAqL1xuICBTY2hlZHVsZXIucHJvdG90eXBlLmV4ZWN1dGUgPSBmdW5jdGlvbigpIHtcbiAgICB2YXIgb2JqZWN0ID0gdGhpcy5fX2V2ZW50UXVldWUuZ2V0Rmlyc3RPYmplY3QoKTtcbiAgICB2YXIgdGltZSA9IHRoaXMuX19ldmVudFF1ZXVlLmdldEZpcnN0VGltZSgpO1xuICAgIHZhciBuZXh0VGltZSA9IG9iamVjdC5leGVjdXRlKHRpbWUpO1xuXG4gICAgdGhpcy5fX2V2ZW50UXVldWUuaW5zZXJ0KG9iamVjdCwgbmV4dFRpbWUpO1xuXG4gICAgcmV0dXJuIHRoaXMuX19ldmVudFF1ZXVlLmdldEZpcnN0VGltZSgpO1xuICB9XG47cmV0dXJuIFNjaGVkdWxlcjt9KSgpO1xuXG5tb2R1bGUuZXhwb3J0cyA9IFNjaGVkdWxlcjsiXX0=
