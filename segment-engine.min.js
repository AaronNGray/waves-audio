!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.SegmentEngine=t()}}(function(){return function t(e,r,i){function n(a,s){if(!r[a]){if(!e[a]){var u="function"==typeof require&&require;if(!s&&u)return u(a,!0);if(o)return o(a,!0);throw new Error("Cannot find module '"+a+"'")}var c=r[a]={exports:{}};e[a][0].call(c.exports,function(t){var r=e[a][1][t];return n(r?r:t)},c,c.exports,t,e,r,i)}return r[a].exports}for(var o="function"==typeof require&&require,a=0;a<i.length;a++)n(i[a]);return n}({1:[function(){!function(){"use strict";function t(t){t&&(t.setTargetAtTime||(t.setTargetAtTime=t.setTargetValueAtTime))}window.hasOwnProperty("webkitAudioContext")&&!window.hasOwnProperty("AudioContext")&&(window.AudioContext=webkitAudioContext,AudioContext.prototype.hasOwnProperty("createGain")||(AudioContext.prototype.createGain=AudioContext.prototype.createGainNode),AudioContext.prototype.hasOwnProperty("createDelay")||(AudioContext.prototype.createDelay=AudioContext.prototype.createDelayNode),AudioContext.prototype.hasOwnProperty("createScriptProcessor")||(AudioContext.prototype.createScriptProcessor=AudioContext.prototype.createJavaScriptNode),AudioContext.prototype.hasOwnProperty("createPeriodicWave")||(AudioContext.prototype.createPeriodicWave=AudioContext.prototype.createWaveTable),AudioContext.prototype.internal_createGain=AudioContext.prototype.createGain,AudioContext.prototype.createGain=function(){var e=this.internal_createGain();return t(e.gain),e},AudioContext.prototype.internal_createDelay=AudioContext.prototype.createDelay,AudioContext.prototype.createDelay=function(e){var r=e?this.internal_createDelay(e):this.internal_createDelay();return t(r.delayTime),r},AudioContext.prototype.internal_createBufferSource=AudioContext.prototype.createBufferSource,AudioContext.prototype.createBufferSource=function(){var e=this.internal_createBufferSource();return e.start||(e.start=function(t,e,r){e||r?this.noteGrainOn(t,e,r):this.noteOn(t)}),e.stop||(e.stop=e.noteOff),t(e.playbackRate),e},AudioContext.prototype.internal_createDynamicsCompressor=AudioContext.prototype.createDynamicsCompressor,AudioContext.prototype.createDynamicsCompressor=function(){var e=this.internal_createDynamicsCompressor();return t(e.threshold),t(e.knee),t(e.ratio),t(e.reduction),t(e.attack),t(e.release),e},AudioContext.prototype.internal_createBiquadFilter=AudioContext.prototype.createBiquadFilter,AudioContext.prototype.createBiquadFilter=function(){var e=this.internal_createBiquadFilter();return t(e.frequency),t(e.detune),t(e.Q),t(e.gain),e},AudioContext.prototype.hasOwnProperty("createOscillator")&&(AudioContext.prototype.internal_createOscillator=AudioContext.prototype.createOscillator,AudioContext.prototype.createOscillator=function(){var e=this.internal_createOscillator();return e.start||(e.start=e.noteOn),e.stop||(e.stop=e.noteOff),e.setPeriodicWave||(e.setPeriodicWave=e.setWaveTable),t(e.frequency),t(e.detune),e}))}(window)},{}],2:[function(t,e){t("./ac-monkeypatch"),e.exports=new AudioContext},{"./ac-monkeypatch":1}],3:[function(t,e){e.exports=t(1)},{}],4:[function(t,e){e.exports=t(2)},{"./ac-monkeypatch":3}],5:[function(t,e){"use strict";var r=t("audio-context"),i=function(){function t(){this.interface=null,this.outputNode=null}function e(){return r.currentTime}function i(){return 0}var n=(function(t,e){return t.__proto__={a:e},t.a===e}({},{}),Object.defineProperty),o=Object.getOwnPropertyDescriptor,a=function(t,e){for(var r in e)e.hasOwnProperty(r)&&n(t,r,o(e,r));return t},s=Object.defineProperties,u={};return s(t.prototype,{currentTime:{get:e,configurable:!0,enumerable:!0},currentPosition:{get:i,configurable:!0,enumerable:!0}}),n(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),u.resetNextTime=function(){var t=arguments[0];void 0===t&&(t=null)},u.resetNextPosition=function(){var t=arguments[0];void 0===t&&(t=null)},u.__setGetters=function(t,e){t&&Object.defineProperty(this,"currentTime",{configurable:!0,get:t,set:function(){}}),e&&Object.defineProperty(this,"currentPosition",{configurable:!0,get:e,set:function(){}})},u.__deleteGetters=function(){delete this.currentTime,delete this.currentPosition},u.connect=function(t){return this.outputNode.connect(t),this},u.disconnect=function(t){return this.outputNode.disconnect(t),this},a(t.prototype,u),u=void 0,t}();i.implementsScheduled=function(t){return t.advanceTime&&t.advanceTime instanceof Function},i.implementsTransported=function(t){return t.syncPosition&&t.syncPosition instanceof Function&&t.advancePosition&&t.advancePosition instanceof Function},i.implementsSpeedControlled=function(t){return t.syncSpeed&&t.syncSpeed instanceof Function},i.setScheduled=function(t,e,r,i){t.interface="scheduled",t.__setGetters(r,i),e&&(t.resetNextTime=e)},i.setTransported=function(t,e,r,i){t.interface="transported",t.__setGetters(r,i),e&&(t.resetNextPosition=e)},i.setSpeedControlled=function(t,e,r){t.interface="speed-controlled",t.__setGetters(e,r)},i.resetInterface=function(t){t.__deleteGetters(),delete t.resetNextTime,delete t.resetNextPosition,t.interface=null},e.exports=i},{"audio-context":4}],6:[function(t,e){"use strict";function r(t,e){var r=arguments[2];void 0===r&&(r=0);var i=t.length;if(i>0){var n=t[0],o=t[i-1];if(n>e)r=-1;else if(e>=o)r=i-1;else{for((0>r||r>=i)&&(r=Math.floor((i-1)*(e-n)/(o-n)));t[r]>e;)r--;for(;t[r+1]<=e;)r++}}return r}function i(t,e){var r=arguments[2];void 0===r&&(r=0);var i=t.length;if(i>0){var n=t[0],o=t[i-1];if(n>=e)r=0;else if(e>=o)r=i;else{for((0>r||r>=i)&&(r=Math.floor((i-1)*(e-n)/(o-n)));t[r]<e;)r++;for(;t[r+1]>=e;)r--}}return r}var n=t("audio-context"),o=t("time-engine"),a=function(t){function e(){var e=arguments[0];void 0===e&&(e=null),t.call(this,!1),this.buffer=e,this.periodAbs=.1,this.periodRel=0,this.periodVar=0,this.positionArray=[0],this.positionVar=0,this.durationArray=[0],this.durationAbs=0,this.durationRel=1,this.offsetArray=[0],this.offsetAbs=-.005,this.offsetRel=0,this.delay=.005,this.attackAbs=.005,this.attackRel=0,this.releaseAbs=.005,this.releaseRel=0,this.resampling=0,this.resamplingVar=0,this.segmentIndex=0,this.cyclic=!1,this.__cyclicOffset=0,this.outputNode=this.__gainNode=n.createGain()}function o(){var t=this.buffer.duration;return this.buffer.wrapAroundExtention&&(t-=this.buffer.wrapAroundExtention),t}function a(t){this.__gainNode.gain.value=t}function s(){return this.__gainNode.gain.value}var u=function(t,e){return t.__proto__={a:e},t.a===e}({},{}),c=Object.defineProperty,f=Object.getOwnPropertyDescriptor,p=function(t,e){for(var r in e)e.hasOwnProperty(r)&&c(t,r,f(e,r));return t},l=Object.setPrototypeOf||function(t,e){return u?t.__proto__=e:c(t,"__proto__",{value:e,configurable:!0,enumerable:!1,writable:!0}),t},d=Object.create;u||p(e,t);var h={};return null!==t&&l(e,t),e.prototype=d(null!==t?t.prototype:null,{constructor:{value:e,configurable:!0,writable:!0},bufferDuration:{get:o,configurable:!0,enumerable:!0},gain:{get:s,set:a,configurable:!0,enumerable:!0}}),c(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),h.advanceTime=function(t){return t+this.trigger(t)},h.syncPosition=function(t,e,n){var o=this.segmentIndex,a=0,s=this.bufferDuration;if(this.cyclic){var u=e/s;a=Math.floor(u)*s,e-=a}if(n>0){if(o=i(this.positionArray,e),o>=this.positionArray.length&&(o=0,a+=s,!this.cyclic))return 1/0}else{if(!(0>n))return 1/0;if(o=r(this.positionArray,e),0>o&&(o=this.positionArray.length-1,a-=s,!this.cyclic))return-1/0}return this.segmentIndex=o,this.__cyclicOffset=a,a+this.positionArray[o]},h.advancePosition=function(t,e,r){var i=this.segmentIndex,n=this.__cyclicOffset;if(this.trigger(t),r>0){if(i++,i>=this.positionArray.length&&(i=0,n+=this.bufferDuration,!this.cyclic))return 1/0}else if(i--,0>i&&(i=this.positionArray.length-1,n-=this.bufferDuration,!this.cyclic))return-1/0;return this.segmentIndex=i,this.__cyclicOffset=n,n+this.positionArray[i]},h.trigger=function(t){var e=t||n.currentTime+this.delay,r=this.periodAbs,i=this.segmentIndex;if(this.buffer){var o=0,a=0,s=0,u=1,c=this.bufferDuration;if(this.cyclic?i%=this.positionArray.length:i=Math.max(0,Math.min(i,this.positionArray.length-1)),this.positionArray&&(o=this.positionArray[i]||0),this.durationArray&&(a=this.durationArray[i]||0),this.offsetArray&&(s=this.offsetArray[i]||0),0!==this.resampling||this.resamplingVar>0){var f=2*(Math.random()-.5)*this.resamplingVar;u=Math.pow(2,(this.resampling+f)/1200)}if(0===a||this.periodRel>0){var p,l,d=i+1;d===this.positionArray.length?this.cyclic?(p=this.positionArray[0]+c,l=this.offsetArray[0]):(p=c,l=0):(p=this.positionArray[d],l=this.offsetArray[d]);var h=p-o;s>0&&(h-=s),l>0&&(h+=l),0>h&&(h=0),0===a&&(a=h),r+=this.periodRel*h}if(a*=this.durationRel,a+=this.durationAbs,s*=this.offsetRel,s+=this.offsetAbs,0>s?(a-=s,o+=s,e+=s/u):e-=s/u,this.positionVar>0&&(o+=2*(Math.random()-.5)*this.positionVar),0>o&&(a+=o,o=0),o+a>this.buffer.duration&&(a=this.buffer.duration-o),this.gain>0&&a>0){var y=n.createGain(),g=this.attackAbs+this.attackRel*a,A=this.releaseAbs+this.releaseRel*a;if(g+A>a){var m=a/(g+A);g*=m,A*=m}var v=e+g,x=e+a,b=x-A;y.gain.value=this.gain,y.gain.setValueAtTime(0,e),y.gain.linearRampToValueAtTime(this.gain,v),b>v&&y.gain.setValueAtTime(this.gain,b),y.gain.linearRampToValueAtTime(0,x),y.connect(this.__gainNode);var _=n.createBufferSource();_.buffer=this.buffer,_.playbackRate.value=u,_.connect(y),y.connect(this.__gainNode),_.start(e,o),_.stop(e+a/u)}}return r},p(e.prototype,h),h=void 0,e}(o);e.exports=a},{"audio-context":2,"time-engine":5}]},{},[6])(6)});