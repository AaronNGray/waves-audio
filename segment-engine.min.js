!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.SegmentEngine=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var f=i[s]={exports:{}};e[s][0].call(f.exports,function(t){var i=e[s][1][t];return r(i?i:t)},f,f.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e){var i=window.audioContext||new AudioContext||new webkitAudioContext;window.audioContext=i,e.exports=i},{}],2:[function(t,e){e.exports=t(1)},{}],3:[function(t,e){"use strict";var i=t("audio-context"),n=function(){function t(){this.interface=null,this.outputNode=null}function e(){return i.currentTime}function n(){return 0}var r=(function(t,e){return t.__proto__={a:e},t.a===e}({},{}),Object.defineProperty),o=Object.getOwnPropertyDescriptor,s=function(t,e){for(var i in e)e.hasOwnProperty(i)&&r(t,i,o(e,i));return t},a=Object.defineProperties,u={};return a(t.prototype,{currentTime:{get:e,configurable:!0,enumerable:!0},currentPosition:{get:n,configurable:!0,enumerable:!0}}),r(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),u.resetNextTime=function(){var t=arguments[0];void 0===t&&(t=null)},u.resetNextPosition=function(){var t=arguments[0];void 0===t&&(t=null)},u.__setGetters=function(t,e){t&&Object.defineProperty(this,"currentTime",{configurable:!0,get:t,set:function(){}}),e&&Object.defineProperty(this,"currentPosition",{configurable:!0,get:e,set:function(){}})},u.__deleteGetters=function(){delete this.currentTime,delete this.currentPosition},u.connect=function(t){return this.outputNode.connect(t),this},u.disconnect=function(t){return this.outputNode.disconnect(t),this},s(t.prototype,u),u=void 0,t}();n.implementsScheduled=function(t){return t.advanceTime&&t.advanceTime instanceof Function},n.implementsTransported=function(t){return t.syncPosition&&t.syncPosition instanceof Function&&t.advancePosition&&t.advancePosition instanceof Function},n.implementsSpeedControlled=function(t){return t.syncSpeed&&t.syncSpeed instanceof Function},n.setScheduled=function(t,e,i,n){t.interface="scheduled",t.__setGetters(i,n),e&&(t.resetNextTime=e)},n.setTransported=function(t,e,i,n){t.interface="transported",t.__setGetters(i,n),e&&(t.resetNextPosition=e)},n.setSpeedControlled=function(t,e,i){t.interface="speed-controlled",t.__setGetters(e,i)},n.resetInterface=function(t){t.__deleteGetters(),delete t.resetNextTime,delete t.resetNextPosition,t.interface=null},e.exports=n},{"audio-context":2}],4:[function(t,e){"use strict";function i(t,e){var i=arguments[2];void 0===i&&(i=0);var n=t.length;if(n>0){var r=t[0],o=t[n-1];if(r>e)i=-1;else if(e>=o)i=n-1;else{for((0>i||i>=n)&&(i=Math.floor((n-1)*(e-r)/(o-r)));t[i]>e;)i--;for(;t[i+1]<=e;)i++}}return i}function n(t,e){var i=arguments[2];void 0===i&&(i=0);var n=t.length;if(n>0){var r=t[0],o=t[n-1];if(r>=e)i=0;else if(e>=o)i=n;else{for((0>i||i>=n)&&(i=Math.floor((n-1)*(e-r)/(o-r)));t[i]<e;)i++;for(;t[i+1]>=e;)i--}}return i}var r=t("audio-context"),o=t("time-engine"),s=function(t){function e(){var e=arguments[0];void 0===e&&(e=null),t.call(this,!1),this.buffer=e,this.periodAbs=.1,this.periodRel=0,this.periodVar=0,this.positionArray=[0],this.positionVar=0,this.durationArray=[0],this.durationAbs=0,this.durationRel=1,this.offsetArray=[0],this.offsetAbs=-.005,this.offsetRel=0,this.delay=.005,this.attackAbs=.005,this.attackRel=0,this.releaseAbs=.005,this.releaseRel=0,this.resampling=0,this.resamplingVar=0,this.segmentIndex=0,this.cyclic=!1,this.__cyclicOffset=0,this.outputNode=this.__gainNode=r.createGain()}function o(){var t=this.buffer.duration;return this.buffer.wrapAroundExtention&&(t-=this.buffer.wrapAroundExtention),t}function s(t){this.__gainNode.gain.value=t}function a(){return this.__gainNode.gain.value}var u=function(t,e){return t.__proto__={a:e},t.a===e}({},{}),f=Object.defineProperty,c=Object.getOwnPropertyDescriptor,l=function(t,e){for(var i in e)e.hasOwnProperty(i)&&f(t,i,c(e,i));return t},h=Object.setPrototypeOf||function(t,e){return u?t.__proto__=e:f(t,"__proto__",{value:e,configurable:!0,enumerable:!1,writable:!0}),t},d=Object.create;u||l(e,t);var p={};return null!==t&&h(e,t),e.prototype=d(null!==t?t.prototype:null,{constructor:{value:e,configurable:!0,writable:!0},bufferDuration:{get:o,configurable:!0,enumerable:!0},gain:{get:a,set:s,configurable:!0,enumerable:!0}}),f(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),p.advanceTime=function(t){return t+this.trigger(t)},p.syncPosition=function(t,e,r){var o=this.segmentIndex,s=0,a=this.bufferDuration;if(this.cyclic){var u=e/a;s=Math.floor(u)*a,e-=s}if(r>0){if(o=n(this.positionArray,e),o>=this.positionArray.length&&(o=0,s+=a,!this.cyclic))return 1/0}else{if(!(0>r))return 1/0;if(o=i(this.positionArray,e),0>o&&(o=this.positionArray.length-1,s-=a,!this.cyclic))return-1/0}return this.segmentIndex=o,this.__cyclicOffset=s,s+this.positionArray[o]},p.advancePosition=function(t,e,i){var n=this.segmentIndex,r=this.__cyclicOffset;if(this.trigger(t),i>0){if(n++,n>=this.positionArray.length&&(n=0,r+=this.bufferDuration,!this.cyclic))return 1/0}else if(n--,0>n&&(n=this.positionArray.length-1,r-=this.bufferDuration,!this.cyclic))return-1/0;return this.segmentIndex=n,this.__cyclicOffset=r,r+this.positionArray[n]},p.trigger=function(t){var e=t||r.currentTime+this.delay,i=this.periodAbs,n=this.segmentIndex;if(this.buffer){var o=0,s=0,a=0,u=1,f=this.bufferDuration;if(this.cyclic?n%=this.positionArray.length:n=Math.max(0,Math.min(n,this.positionArray.length-1)),this.positionArray&&(o=this.positionArray[n]||0),this.durationArray&&(s=this.durationArray[n]||0),this.offsetArray&&(a=this.offsetArray[n]||0),0!==this.resampling||this.resamplingVar>0){var c=2*(Math.random()-.5)*this.resamplingVar;u=Math.pow(2,(this.resampling+c)/1200)}if(0===s||this.periodRel>0){var l,h,d=n+1;d===this.positionArray.length?this.cyclic?(l=this.positionArray[0]+f,h=this.offsetArray[0]):(l=f,h=0):(l=this.positionArray[d],h=this.offsetArray[d]);var p=l-o;a>0&&(p-=a),h>0&&(p+=h),0>p&&(p=0),0===s&&(s=p),i+=this.periodRel*p}if(s*=this.durationRel,s+=this.durationAbs,a*=this.offsetRel,a+=this.offsetAbs,0>a?(s-=a,o+=a,e+=a/u):e-=a/u,this.positionVar>0&&(o+=2*(Math.random()-.5)*this.positionVar),0>o&&(s+=o,o=0),o+s>this.buffer.duration&&(s=this.buffer.duration-o),this.gain>0&&s>0){var g=r.createGain(),y=this.attackAbs+this.attackRel*s,b=this.releaseAbs+this.releaseRel*s;if(y+b>s){var m=s/(y+b);y*=m,b*=m}var v=e+y,_=e+s,A=_-b;g.gain.value=this.gain,g.gain.setValueAtTime(0,e),g.gain.linearRampToValueAtTime(this.gain,v),A>v&&g.gain.setValueAtTime(this.gain,A),g.gain.linearRampToValueAtTime(0,_),g.connect(this.__gainNode);var x=r.createBufferSource();x.buffer=this.buffer,x.playbackRate.value=u,x.connect(g),g.connect(this.__gainNode),x.start(e,o),x.stop(e+s/u)}}return i},l(e.prototype,p),p=void 0,e}(o);e.exports=s},{"audio-context":1,"time-engine":3}]},{},[4])(4)});