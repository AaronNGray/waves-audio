!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.GranularEngine=t()}}(function(){return function t(e,i,n){function r(s,a){if(!i[s]){if(!e[s]){var u="function"==typeof require&&require;if(!a&&u)return u(s,!0);if(o)return o(s,!0);throw new Error("Cannot find module '"+s+"'")}var c=i[s]={exports:{}};e[s][0].call(c.exports,function(t){var i=e[s][1][t];return r(i?i:t)},c,c.exports,t,e,i,n)}return i[s].exports}for(var o="function"==typeof require&&require,s=0;s<n.length;s++)r(n[s]);return r}({1:[function(t,e){var i=window.audioContext||new AudioContext||new webkitAudioContext;window.audioContext=i,e.exports=i},{}],2:[function(t,e){"use strict";var i=t("../audio-context"),n=t("../time-engine"),r=function(t){function e(){var e=arguments[0];void 0===e&&(e=null),t.call(this),this.buffer=e,this.periodAbs=.01,this.periodRel=0,this.periodVar=0,this.position=0,this.positionVar=.003,this.durationAbs=.1,this.durationRel=0,this.attackAbs=0,this.attackRel=.5,this.releaseAbs=0,this.releaseRel=.5,this.resampling=0,this.resamplingVar=0,this.centered=!0,this.cyclic=!1,this.__phase=0,this.__aligned=!0,this.outputNode=this.__gainNode=i.createGain()}function n(t){this.__gainNode.gain.value=t}function r(){return this.__gainNode.gain.value}var o=Object.defineProperty,s=function(t,e){for(var i in e)e.hasOwnProperty(i)&&o(t,i,Object.getOwnPropertyDescriptor(e,i));return t};s(e,t);var a={};return e.prototype=Object.create(t.prototype,{constructor:{value:e,configurable:!0,writable:!0},gain:{get:r,set:n,configurable:!0,enumerable:!0}}),o(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),a.advanceTime=function(t){return t+this.trigger(t)},a.trigger=function(t){var e=t||i.currentTime,n=this.periodAbs,r=this.position,o=this.durationAbs;if(this.buffer){var s=1;if(0!==this.resampling||this.resamplingVar>0){var a=2*(Math.random()-.5)*this.resamplingVar;s=Math.pow(2,(this.resampling+a)/1200)}n+=this.periodRel*o,o+=this.durationRel*n,this.periodVar>0&&(n+=2*(Math.random()-.5)*this.periodVar*n),this.centered&&(r-=.5*o),this.positionVar>0&&(r+=(2*Math.random()-1)*this.positionVar);var u=this.buffer.duration;if(this.buffer.wrapAroundExtention&&(u-=this.buffer.wrapAroundExtention),0>r||r>=u)if(this.cyclic){var c=r/u;r=(c-Math.floor(c))*u,r+o>this.buffer.duration&&(o=this.buffer.duration-r)}else 0>r&&(e-=r,o+=r,r=0),r+o>u&&(o=u-r);if(this.gain>0&&o>=.001){var f=i.createGain(),h=this.attackAbs+this.attackRel*o,l=this.releaseAbs+this.releaseRel*o;if(h+l>o){var p=o/(h+l);h*=p,l*=p}var d=e+h,g=e+o,b=g-l;f.gain.setValueAtTime(0,e),f.gain.linearRampToValueAtTime(1,d),b>d&&f.gain.setValueAtTime(1,b),f.gain.linearRampToValueAtTime(0,g),f.connect(this.__gainNode);var m=i.createBufferSource();m.buffer=this.buffer,m.playbackRate.value=s,m.connect(f),f.connect(this.__gainNode),m.start(e,r),m.stop(e+o/s)}}return n},s(e.prototype,a),a=void 0,e}(n);e.exports=r},{"../audio-context":1,"../time-engine":3}],3:[function(t,e){"use strict";var i=function(){function t(){this.__timeMaster=null,this.getMasterTime=function(){return 0},this.resetEngineTime=function(){},this.__positionMaster=null,this.__startPosition=0,this.getMasterPosition=function(){return 0},this.resyncEnginePosition=function(){},this.outputNode=null}function e(t){this.__timeMaster=t}function i(){return this.__timeMaster}function n(t){this.__positionMaster=t}function r(){return this.__positionMaster}function o(){return this.advanceTime&&this.advanceTime instanceof Function}function s(){return this.syncPosition&&this.syncPosition instanceof Function&&this.advancePosition&&this.advancePosition instanceof Function}function a(){return Object.getOwnPropertyDescriptor(Object.getPrototypeOf(this),"speed")&&this.seek&&this.seek instanceof Function}var u=Object.defineProperty,c=function(t,e){for(var i in e)e.hasOwnProperty(i)&&u(t,i,Object.getOwnPropertyDescriptor(e,i));return t},f={};return Object.defineProperties(t.prototype,{timeMaster:{get:i,set:e,configurable:!0,enumerable:!0},positionMaster:{get:r,set:n,configurable:!0,enumerable:!0},implementsTimeBased:{get:o,configurable:!0,enumerable:!0},implementsPositionBased:{get:s,configurable:!0,enumerable:!0},implementsSpeedBased:{get:a,configurable:!0,enumerable:!0}}),u(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),f.initTime=function(t){return t},f.connect=function(t){return this.outputNode.connect(t),this},f.disconnect=function(t){return this.outputNode.disconnect(t),this},c(t.prototype,f),f=void 0,t}();e.exports=i},{}]},{},[2])(2)});