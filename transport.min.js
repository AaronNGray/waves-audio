!function(t){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=t();else if("function"==typeof define&&define.amd)define([],t);else{var e;"undefined"!=typeof window?e=window:"undefined"!=typeof global?e=global:"undefined"!=typeof self&&(e=self),e.Transport=t()}}(function(){return function t(e,i,n){function s(_,r){if(!i[_]){if(!e[_]){var h="function"==typeof require&&require;if(!r&&h)return h(_,!0);if(o)return o(_,!0);throw new Error("Cannot find module '"+_+"'")}var v=i[_]={exports:{}};e[_][0].call(v.exports,function(t){var i=e[_][1][t];return s(i?i:t)},v,v.exports,t,e,i,n)}return i[_].exports}for(var o="function"==typeof require&&require,_=0;_<n.length;_++)s(n[_]);return s}({1:[function(t,e){"use strict";function i(t,e){var i=t.indexOf(e);return i>=0?(t.splice(i,1),!0):!1}var n=t("event-queue"),s=t("event-engine"),o=function(t){function e(t){if(t){if(Array.isArray(t))return 0;var e;if(l&&l(t),"object"==typeof t&&"function"==typeof(e=t[f]))return l&&l(void 0),e.call(t);if(l&&l(void 0),t+""=="[object Generator]")return t}throw new Error(t+" is not iterable")}function s(){t.call(this),this.__timeEvents=new n,this.__timeEngines=[],this.__nextEventTime=1/0,this.__positionEvents=new n,this.__positionEngines=[],this.__nextEventPosition=1/0,this.__nextTime=1/0,this.__time=1/0,this.__position=0,this.__speed=0,this.__speedAndSeekListeners=[],this.__playingSpeed=1}function o(){return this.scheduler.time}function _(){var t=this.scheduler.time;return this.getPositionAtTime(t)}function r(){return this.__speed}function h(){return this.__speed<0}function v(t){var i,n,s,o,_=this.__speed;if(t!==_){this.__sync(this.time),this.__speed=t,0===_?(this.__timeEvents.clear(),this.__nextEventTime=this.__timeEvents.insertAll(this.__timeEngines,this.__time),this.__positionEvents.reverse=0>t,this.__positionEvents.clear(),this.__nextEventPosition=this.__positionEvents.insertAll(this.__positionEngines,this.__position)):0===t?(this.__nextEventTime=1/0,this.__nextEventPosition=1/0):0>t*_&&(this.__positionEvents.reverse=0>t,this.__positionEvents.clear(),this.__nextEventPosition=this.__positionEvents.insertAll(this.__positionEngines,this.__position)),this.__reschedule(),o=this.__speedAndSeekListeners,i=e(o),s=0===i,n=s?o.length:void 0;for(var r;s?n>i:!(n=i.next()).done;)r=s?o[i++]:n.value,r.speed=t;i=n=s=o=void 0}}function u(t){t>=0?.0625>t?t=.0625:t>16&&(t=16):-16>t?t=-16:t>-.0625&&(t=-.0625),this.__playingSpeed=t,0!==this.__speed&&(this.speed=t)}function p(){return this.__playingSpeed}var c=Object.defineProperty,a=function(t,e){for(var i in e)e.hasOwnProperty(i)&&c(t,i,Object.getOwnPropertyDescriptor(e,i));return t};a(s,t);var d={},f="undefined"!=typeof Symbol&&Symbol&&Symbol.iterator||"@@iterator",l="undefined"!=typeof Symbol&&Symbol&&Symbol.__setObjectSetter__;return s.prototype=Object.create(t.prototype,{constructor:{value:s,configurable:!0,writable:!0},time:{get:o,configurable:!0,enumerable:!0},position:{get:_,configurable:!0,enumerable:!0},speed:{get:r,set:v,configurable:!0,enumerable:!0},reverse:{get:h,configurable:!0,enumerable:!0},playingSpeed:{get:p,set:u,configurable:!0,enumerable:!0}}),c(s,"prototype",{configurable:!1,enumerable:!1,writable:!1}),d.__sync=function(t){this.__position+=(t-this.__time)*this.__speed,this.__time=t},d.__reschedule=function(){var t;t=1/0!==this.__nextEventPosition?Math.min(this.__nextEventTime,this.getTimeAtPosition(this.__nextEventPosition)):this.__nextEventTime,t!==this.__nextTime&&(this.__nextTime=t,this.rescheduleEngine(t))},d.syncEvent=function(t){return this.__nextEventTime=1/0,this.__nextEventPosition=1/0,this.__time=t,this.__speed&&(this.__timeEvents.clear(),this.__nextEventTime=this.__timeEvents.insertAll(this.__timeEngines,t),this.__positionEvents.reverse=this.__speed<0,this.__positionEvents.clear(),this.__nextEventPosition=this.__positionEvents.insertAll(this.__positionEngines,this.__position)),this.__nextTime=1/0!==this.__nextEventPosition?Math.min(this.__nextEventTime,this.getTimeAtPosition(this.__nextEventPosition)):this.__nextEventTime,this.__nextTime-t},d.executeEvent=function(t,e){return this.__sync(t),this.__nextTime===this.__nextEventTime?this.__nextEventTime=this.__timeEvents.advance(t,e):this.__nextEventPosition=this.__positionEvents.advance(this.__position,e),this.__nextTime=1/0!==this.__nextEventPosition?Math.min(this.__nextEventTime,this.getTimeAtPosition(this.__nextEventPosition)):this.__nextEventTime,this.__nextTime-t},d.getPositionAtTime=function(t){return this.__position+(t-this.__time)*this.__speed},d.getTimeAtPosition=function(t){return this.__time+(t-this.__position)/this.__speed},d.seek=function(t){var i,n,s,o;if(this.__sync(this.time),t!==this.__position&&(this.__position=t,0!==this.__speed)){this.__positionEvents.clear(),this.__nextEventPosition=this.__positionEvents.insertAll(this.__positionEngines,this.__position,!0),this.__reschedule(),o=this.__speedAndSeekListeners,i=e(o),s=0===i,n=s?o.length:void 0;for(var _;s?n>i:!(n=i.next()).done;)_=s?o[i++]:n.value,_.seek(t);i=n=s=o=void 0}},d.add=function(t){if(t.transport||t.scheduler)throw"object has already been added to a transport";if(t.transport=this,t.scheduler=this,this.__sync(this.time),t.syncEvent&&t.executeEvent)t.alignEventsToTransportPosition?(0!==this.__speed&&(this.__nextEventPosition=this.__positionEvents.insert(t,this.__position)),this.__positionEngines.push(t)):(0!==this.__speed&&(this.__nextEventTime=this.__timeEvents.insert(t,this.__time)),this.__timeEngines.push(t)),0!==this.__speed&&this.__reschedule();else{if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),"speed")||"function"!=typeof t.seek)throw"cannot add an object to transport that is not an EventEngine nor has a speed attribute and seek method";this.__speedAndSeekListeners.push(t),t.speed=this.__speed}},d.remove=function(t){if(t.transport!==this)throw"object has not been added to this transport";t.transport=null,t.scheduler=null,this.__sync(this.time),t.syncEvent&&t.executeEvent?(t.alignEventsToTransportPosition?(this.__nextEventPosition=this.__positionEvents.remove(t),i(this.__positionEngines,t)):(this.__nextEventTime=this.__timeEvents.remove(t),i(this.__timeEngines,t)),0!==this.__speed&&this.__reschedule()):Object.getOwnPropertyDescriptor(Object.getPrototypeOf(t),"speed")&&"function"==typeof t.seek&&(t.speed=0,i(this.__speedAndSeekListeners,t))},d.resync=function(t){if(t.transport!==this)throw"object has not been added to this transport";this.__sync(this.time),0!==this._speed&&(t.alignEventsToTransportPosition?this.__nextEventPosition=this.__positionEvents.move(t,this.__position):this.__nextEventTime=this.__timeEvents.move(t,this.__time),this.__reschedule())},d.reschedule=function(t,e){if(t.transport!==this)throw"object has not been added to this transport";this.__sync(this.time),0!==this._speed&&(t.alignEventsToTransportPosition?this.__nextEventPosition=this.__positionEvents.move(t,e,!1):this.__nextEventTime=this.__timeEvents.move(t,e,!1),this.__reschedule())},d.startPlaying=function(){var t=arguments[0];void 0===t&&(t=null);var e=arguments[1];void 0===e&&(e=null),t&&this.seek(t),e&&(this.playingSpeed=e),this.speed=this.playingSpeed},d.pausePlaying=function(){this.speed=0},d.stopPlaying=function(){this.speed=0,this.seek(0)},a(s.prototype,d),d=void 0,s}(s);e.exports=o},{"event-engine":2,"event-queue":3}],2:[function(t,e){"use strict";var i=function(){function t(){var t=arguments[0];void 0===t&&(t=!0),this.scheduler=null,this.transport=null,this.alignToTransportPosition=t,this.outputNode=null}var e=Object.defineProperty;return e(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t.prototype.syncEvent=function(){return 1/0},t.prototype.executeEvent=function(){return 1/0},t.prototype.resyncEngine=function(){this.scheduler&&this.scheduler.resync(this)},t.prototype.rescheduleEngine=function(t){this.scheduler&&this.scheduler.reschedule(this,t)},t.prototype.connect=function(t){return this.outputNode.connect(t),this},t.prototype.disconnect=function(t){return this.outputNode.disconnect(t),this},t}();e.exports=i},{}],3:[function(t,e){"use strict";var i=function(){function t(){this.__events=[],this.reverse=!1}var e=Object.defineProperty;return e(t,"prototype",{configurable:!1,enumerable:!1,writable:!1}),t.prototype.__eventIndex=function(t){for(var e=0;e<this.__events.length;e++)if(t===this.__events[e][0])return e;return-1},t.prototype.__removeEvent=function(t){var e=this.__eventIndex(t);return e>=0&&this.__events.splice(e,1),this.__events.length>0?this.__events[0][1]:1/0},t.prototype.__syncEvent=function(t,e){var i=Math.max(t.syncEvent(e),0),n=1/0;return 1/0!==i&&(n=this.reverse?e-i:e+i),n},t.prototype.__sortEvents=function(){this.reverse?this.__events.sort(function(t,e){return e[1]-t[1]}):this.__events.sort(function(t,e){return t[1]-e[1]})},t.prototype.insert=function(t,e){var i=arguments[2];void 0===i&&(i=!0);var n=e;return i&&(n=this.__syncEvent(t,e)),1/0!==n?(this.__events.push([t,n]),this.__sortEvents(),this.__events[0][1]):this.__removeEvent(t)},t.prototype.insertAll=function(t,e){var i=arguments[2];void 0===i&&(i=!0);for(var n=e,s=0;s<t.length;s++){var o=t[s];i&&(n=this.__syncEvent(o,e)),1/0!==n&&this.__events.push([o,n])}return this.__sortEvents(),this.__events.length>0?this.__events[0][1]:1/0},t.prototype.move=function(t,e){var i=arguments[2];void 0===i&&(i=!0);var n=e;if(i&&(n=this.__syncEvent(t,e)),1/0!==n){var s=this.__eventIndex(t);if(0>s)this.__events.push([t,n]),this.__sortEvents();else if(this.__events[s][1]=n,0===s&&this.__events.length>1){var o=this.__events[1][1];(!this.reverse&&n>o||this.reverse&&o>=n)&&this.__sortEvents()}return this.__events[0][1]}return this.__removeEvent(t)},t.prototype.remove=function(t){return this.__removeEvent(t)},t.prototype.clear=function(){return this.__events.length=0,1/0},t.prototype.advance=function(t,e){var i=this.__events[0][0],n=Math.max(i.executeEvent(t,e),0);if(1/0!==n){var s;if(s=this.reverse?t-n:t+n,this.__events[0][1]=s,this.__events.length>1){var o=this.__events[1][1];(!this.reverse&&s>o||this.reverse&&o>=s)&&this.__sortEvents()}return this.__events[0][1]}return this.__removeEvent(i)},t}();e.exports=i},{}]},{},[1])(1)});