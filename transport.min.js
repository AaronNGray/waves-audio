!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{var t;"undefined"!=typeof window?t=window:"undefined"!=typeof global?t=global:"undefined"!=typeof self&&(t=self),t.Transport=e()}}(function(){return function e(t,i,n){function s(r,_){if(!i[r]){if(!t[r]){var h="function"==typeof require&&require;if(!_&&h)return h(r,!0);if(o)return o(r,!0);throw new Error("Cannot find module '"+r+"'")}var u=i[r]={exports:{}};t[r][0].call(u.exports,function(e){var i=t[r][1][e];return s(i?i:e)},u,u.exports,e,t,i,n)}return i[r].exports}for(var o="function"==typeof require&&require,r=0;r<n.length;r++)s(n[r]);return s}({1:[function(e,t){"use strict";function i(e,t){var i=e.indexOf(t);return i>=0?(e.splice(i,1),!0):!1}var n=e("time-engine"),s=e("time-engine-queue"),o=function(e){function t(e){if(e){if(Array.isArray(e))return 0;var t;if(v&&v(e),"object"==typeof e&&"function"==typeof(t=e[l]))return v&&v(void 0),t.call(e);if(v&&v(void 0),e+""=="[object Generator]")return e}throw new Error(e+" is not iterable")}function n(){e.call(this),this.__timeQueue=new s,this.__timeEngines=[],this.__nextEngineTime=1/0,this.__positionQueue=new s,this.__positionEngines=[],this.__nextEnginePosition=1/0,this.__nextTime=1/0,this.__time=1/0,this.__position=0,this.__speed=0,this.__speedAndSeekListeners=[],this.__playingSpeed=1}function o(){return this.scheduler.time}function r(){var e=this.scheduler.time;return this.getPositionAtTime(e)}function _(){return this.__speed}function h(){return this.__speed<0}function u(e){var i,n,s,o,r=this.__speed;if(e!==r){this.__sync(this.time),this.__speed=e,0===r?(this.__timeQueue.clear(),this.__nextEngineTime=this.__timeQueue.insertAll(this.__timeEngines,this.__time),this.__positionQueue.reverse=0>e,this.__positionQueue.clear(),this.__nextEnginePosition=this.__positionQueue.insertAll(this.__positionEngines,this.__position)):0===e?(this.__nextEngineTime=1/0,this.__nextEnginePosition=1/0):0>e*r&&(this.__positionQueue.reverse=0>e,this.__positionQueue.clear(),this.__nextEnginePosition=this.__positionQueue.insertAll(this.__positionEngines,this.__position)),this.__reschedule(),o=this.__speedAndSeekListeners,i=t(o),s=0===i,n=s?o.length:void 0;for(var _;s?n>i:!(n=i.next()).done;)_=s?o[i++]:n.value,_.speed=e;i=n=s=o=void 0}}function c(e){e>=0?.0625>e?e=.0625:e>16&&(e=16):-16>e?e=-16:e>-.0625&&(e=-.0625),this.__playingSpeed=e,0!==this.__speed&&(this.speed=e)}function p(){return this.__playingSpeed}var a=Object.defineProperty,d=function(e,t){for(var i in t)t.hasOwnProperty(i)&&a(e,i,Object.getOwnPropertyDescriptor(t,i));return e};d(n,e);var f={},l="undefined"!=typeof Symbol&&Symbol&&Symbol.iterator||"@@iterator",v="undefined"!=typeof Symbol&&Symbol&&Symbol.__setObjectSetter__;return n.prototype=Object.create(e.prototype,{constructor:{value:n,configurable:!0,writable:!0},time:{get:o,configurable:!0,enumerable:!0},position:{get:r,configurable:!0,enumerable:!0},speed:{get:_,set:u,configurable:!0,enumerable:!0},reverse:{get:h,configurable:!0,enumerable:!0},playingSpeed:{get:p,set:c,configurable:!0,enumerable:!0}}),a(n,"prototype",{configurable:!1,enumerable:!1,writable:!1}),f.__sync=function(e){this.__position+=(e-this.__time)*this.__speed,this.__time=e},f.__reschedule=function(){var e;e=1/0!==this.__nextEnginePosition?Math.min(this.__nextEngineTime,this.getTimeAtPosition(this.__nextEnginePosition)):this.__nextEngineTime,e!==this.__nextTime&&(this.__nextTime=e,this.rescheduleEngine(e))},f.syncNext=function(e){return this.__nextEngineTime=1/0,this.__nextEnginePosition=1/0,this.__time=e,this.__speed&&(this.__timeQueue.clear(),this.__nextEngineTime=this.__timeQueue.insertAll(this.__timeEngines,e),this.__positionQueue.reverse=this.__speed<0,this.__positionQueue.clear(),this.__nextEnginePosition=this.__positionQueue.insertAll(this.__positionEngines,this.__position)),this.__nextTime=1/0!==this.__nextEnginePosition?Math.min(this.__nextEngineTime,this.getTimeAtPosition(this.__nextEnginePosition)):this.__nextEngineTime,this.__nextTime-e},f.executeNext=function(e,t){return this.__sync(e),this.__nextTime===this.__nextEngineTime?this.__nextEngineTime=this.__timeQueue.execute(e,t):this.__nextEnginePosition=this.__positionQueue.execute(this.__position,t),this.__nextTime=1/0!==this.__nextEnginePosition?Math.min(this.__nextEngineTime,this.getTimeAtPosition(this.__nextEnginePosition)):this.__nextEngineTime,this.__nextTime-e},f.getPositionAtTime=function(e){return this.__position+(e-this.__time)*this.__speed},f.getTimeAtPosition=function(e){return this.__time+(e-this.__position)/this.__speed},f.seek=function(e){var i,n,s,o;if(this.__sync(this.time),e!==this.__position&&(this.__position=e,0!==this.__speed)){this.__positionQueue.clear(),this.__nextEnginePosition=this.__positionQueue.insertAll(this.__positionEngines,this.__position,!0),this.__reschedule(),o=this.__speedAndSeekListeners,i=t(o),s=0===i,n=s?o.length:void 0;for(var r;s?n>i:!(n=i.next()).done;)r=s?o[i++]:n.value,r.seek(e);i=n=s=o=void 0}},f.add=function(e){if(e.transport||e.scheduler)throw new Error("object has already been added to a transport");if(e.transport=this,e.scheduler=this,this.__sync(this.time),e.syncNext&&e.executeNext)e.alignToTransportPosition?(0!==this.__speed&&(this.__nextEnginePosition=this.__positionQueue.insert(e,this.__position)),this.__positionEngines.push(e)):(0!==this.__speed&&(this.__nextEngineTime=this.__timeQueue.insert(e,this.__time)),this.__timeEngines.push(e)),0!==this.__speed&&this.__reschedule();else{if(!Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"speed")||"function"!=typeof e.seek)throw new Error("cannot add an object to transport that is not an TimeEngine nor has a speed attribute and seek method");this.__speedAndSeekListeners.push(e),e.speed=this.__speed}},f.remove=function(e){if(e.transport!==this)throw new Error("object has not been added to this transport");e.transport=null,e.scheduler=null,this.__sync(this.time),e.syncNext&&e.executeNext?(e.alignToTransportPosition?(this.__nextEnginePosition=this.__positionQueue.remove(e),i(this.__positionEngines,e)):(this.__nextEngineTime=this.__timeQueue.remove(e),i(this.__timeEngines,e)),0!==this.__speed&&this.__reschedule()):Object.getOwnPropertyDescriptor(Object.getPrototypeOf(e),"speed")&&"function"==typeof e.seek&&(e.speed=0,i(this.__speedAndSeekListeners,e))},f.resync=function(e){if(e.transport!==this)throw new Error("object has not been added to this transport");this.__sync(this.time),0!==this._speed&&(e.alignToTransportPosition?this.__nextEnginePosition=this.__positionQueue.move(e,this.__position):this.__nextEngineTime=this.__timeQueue.move(e,this.__time),this.__reschedule())},f.reschedule=function(e,t){if(e.transport!==this)throw new Error("object has not been added to this transport");this.__sync(this.time),0!==this._speed&&(e.alignToTransportPosition?this.__nextEnginePosition=this.__positionQueue.move(e,t,!1):this.__nextEngineTime=this.__timeQueue.move(e,t,!1),this.__reschedule())},f.startPlaying=function(){var e=arguments[0];void 0===e&&(e=null);var t=arguments[1];void 0===t&&(t=null),e&&this.seek(e),t&&(this.playingSpeed=t),this.speed=this.playingSpeed},f.pausePlaying=function(){this.speed=0},f.stopPlaying=function(){this.speed=0,this.seek(0)},d(n.prototype,f),f=void 0,n}(n);t.exports=o},{"time-engine":3,"time-engine-queue":2}],2:[function(e,t){"use strict";var i=function(){function e(){this.__events=[],this.reverse=!1}var t=Object.defineProperty,i=function(e,i){for(var n in i)i.hasOwnProperty(n)&&t(e,n,Object.getOwnPropertyDescriptor(i,n));return e},n={};return t(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),n.__eventIndex=function(e){for(var t=0;t<this.__events.length;t++)if(e===this.__events[t][0])return t;return-1},n.__removeEvent=function(e){var t=this.__eventIndex(e);return t>=0&&this.__events.splice(t,1),this.__events.length>0?this.__events[0][1]:1/0},n.__syncEvent=function(e,t){var i=Math.max(e.syncNext(t),0),n=1/0;return 1/0!==i&&(n=this.reverse?t-i:t+i),n},n.__sortEvents=function(){this.reverse?this.__events.sort(function(e,t){return t[1]-e[1]}):this.__events.sort(function(e,t){return e[1]-t[1]})},n.insert=function(e,t){var i=arguments[2];void 0===i&&(i=!0);var n=t;return i&&(n=this.__syncEvent(e,t)),1/0!==n?(this.__events.push([e,n]),this.__sortEvents(),this.__events[0][1]):this.__removeEvent(e)},n.insertAll=function(e,t){var i=arguments[2];void 0===i&&(i=!0);for(var n=t,s=0;s<e.length;s++){var o=e[s];i&&(n=this.__syncEvent(o,t)),1/0!==n&&this.__events.push([o,n])}return this.__sortEvents(),this.__events.length>0?this.__events[0][1]:1/0},n.move=function(e,t){var i=arguments[2];void 0===i&&(i=!0);var n=t;if(i&&(n=this.__syncEvent(e,t)),1/0!==n){var s=this.__eventIndex(e);if(0>s)this.__events.push([e,n]),this.__sortEvents();else if(this.__events[s][1]=n,0===s&&this.__events.length>1){var o=this.__events[1][1];(!this.reverse&&n>o||this.reverse&&o>=n)&&this.__sortEvents()}return this.__events[0][1]}return this.__removeEvent(e)},n.remove=function(e){return this.__removeEvent(e)},n.clear=function(){return this.__events.length=0,1/0},n.execute=function(e,t){var i=this.__events[0][0],n=Math.max(i.executeNext(e,t),0);if(1/0!==n){var s;if(s=this.reverse?e-n:e+n,this.__events[0][1]=s,this.__events.length>1){var o=this.__events[1][1];(!this.reverse&&s>o||this.reverse&&o>=s)&&this.__sortEvents()}return this.__events[0][1]}return this.__removeEvent(i)},i(e.prototype,n),n=void 0,e}();t.exports=i},{}],3:[function(e,t){"use strict";var i=function(){function e(){var e=arguments[0];void 0===e&&(e=!0),this.scheduler=null,this.transport=null,this.alignToTransportPosition=e,this.outputNode=null}var t=Object.defineProperty,i=function(e,i){for(var n in i)i.hasOwnProperty(n)&&t(e,n,Object.getOwnPropertyDescriptor(i,n));return e},n={};return t(e,"prototype",{configurable:!1,enumerable:!1,writable:!1}),n.syncNext=function(){return 1/0},n.executeNext=function(){return 1/0},n.resyncEngine=function(){this.scheduler&&this.scheduler.resync(this)},n.rescheduleEngine=function(e){this.scheduler&&this.scheduler.reschedule(this,e)},n.connect=function(e){return this.outputNode.connect(e),this},n.disconnect=function(e){return this.outputNode.disconnect(e),this},i(e.prototype,n),n=void 0,e}();t.exports=i},{}]},{},[1])(1)});